<!-- to show the singl post with all comments, likes  -->

<%- include('../partials/header') %>
    <!-- show post itself -->
    <section class="post-itself">
        <div>
            <img alt="avatar" src="<%= post.userAvatar %>">
        </div>
        <div>
            <%=post.userName%>
        </div>
        <div>
            <%=post.content%>
        </div>
        <div class="metadata">
            <% if (user?._id.equals(post.user)) { %>
                <a href="/posts/<%= post._id %>/edit">
                  Edit
                </a>
              <% } %>
        </div>
        <div class="metadata">
            <% if (user?._id.equals(post.user)) { %>
                <form action="/posts/<%= post._id %>?_method=DELETE" method="POST">
                  <button type="submit"> </button>
                </form>
              <% } %>
        </div>
        <!-- to add timestamp -->
    </section>
    <br><br>


    <!-- userto add new comment -->
    <form id="add-comment-form" method="POST" action="/posts/<%=post._id%>/comments">
        <textarea name="content" placeholder="Add a comment"></textarea>
        <input type="submit" value="Comment">
    </form>
    <br><br>


    <!-- show post comments -->
    <!-- get commentd array from the post -->
    <!-- list each comment -->
    <%if (post.comments.length) {%>

        <section class="comment">
            <%post.comments.forEach(function(c){%>
                <div>
                    <img alt="avatar" src="<%= c.userAvatar %>">
                </div>
                <div>
                    <%=c.userName%>
                </div>
                <div>
                    <%=c.content%>
                </div>
                <div class="metadata">
                    <%=c.createdAt.toLocaleDateString().slice(0,23)%>
                </div>

                <div class="metadata">
                    <% if (user?._id.equals(c.user)) { %>
                        <form action="/comments/<%= c._id %>?_method=DELETE" method="POST">
                          <button type="submit"> </button>
                        </form>
                      <% } %>
                </div>
                <!-- to sorted by time -->
                <%})%>

        </section>
        <%} else { %>
            <p>No comment yet</p>
            <%}%>

                <%- include('../partials/footer') %>